{"ast":null,"code":"import CandlestickChart from '../candlestick-chart/candlestick-chart';\nimport VerticalBoxPlot from './vertical-box-plot';\nimport BoxPlot from './box-plot';\nimport ClusterLayout from '../layout/cluster-layout';\nimport areNumbers from '../utils/are-numbers';\nimport { MIN_VALUE, MAX_VALUE } from '../../common/constants';\nimport { defined } from '../../common';\n\nvar BoxPlotChart = function (CandlestickChart) {\n  function BoxPlotChart() {\n    CandlestickChart.apply(this, arguments);\n  }\n\n  if (CandlestickChart) BoxPlotChart.__proto__ = CandlestickChart;\n  BoxPlotChart.prototype = Object.create(CandlestickChart && CandlestickChart.prototype);\n  BoxPlotChart.prototype.constructor = BoxPlotChart;\n\n  BoxPlotChart.prototype.addValue = function addValue(data, fields) {\n    var categoryIx = fields.categoryIx;\n    var category = fields.category;\n    var series = fields.series;\n    var seriesIx = fields.seriesIx;\n    var ref = this;\n    var children = ref.children;\n    var options = ref.options;\n    var value = data.valueFields;\n    var valueParts = this.splitValue(value);\n    var hasValue = areNumbers(valueParts);\n    var dataItem = series.data[categoryIx];\n    var categoryPoints = this.categoryPoints[categoryIx];\n    var point;\n\n    if (!categoryPoints) {\n      this.categoryPoints[categoryIx] = categoryPoints = [];\n    }\n\n    if (hasValue) {\n      point = this.createPoint(data, fields);\n    }\n\n    var cluster = children[categoryIx];\n\n    if (!cluster) {\n      cluster = new ClusterLayout({\n        vertical: options.invertAxes,\n        gap: options.gap,\n        spacing: options.spacing,\n        rtl: !options.invertAxes && (this.chartService || {}).rtl\n      });\n      this.append(cluster);\n    }\n\n    if (point) {\n      this.updateRange(value, fields);\n      cluster.append(point);\n      point.categoryIx = categoryIx;\n      point.category = category;\n      point.series = series;\n      point.seriesIx = seriesIx;\n      point.owner = this;\n      point.dataItem = dataItem;\n    }\n\n    this.points.push(point);\n    categoryPoints.push(point);\n  };\n\n  BoxPlotChart.prototype.pointType = function pointType() {\n    if (this.options.invertAxes) {\n      return VerticalBoxPlot;\n    }\n\n    return BoxPlot;\n  };\n\n  BoxPlotChart.prototype.splitValue = function splitValue(value) {\n    return [value.lower, value.q1, value.median, value.q3, value.upper];\n  };\n\n  BoxPlotChart.prototype.updateRange = function updateRange(value, fields) {\n    var axisName = fields.series.axis;\n    var axisRange = this.valueAxisRanges[axisName];\n    var parts = this.splitValue(value).concat(this.filterOutliers(value.outliers));\n\n    if (defined(value.mean)) {\n      parts = parts.concat(value.mean);\n    }\n\n    axisRange = this.valueAxisRanges[axisName] = axisRange || {\n      min: MAX_VALUE,\n      max: MIN_VALUE\n    };\n    axisRange = this.valueAxisRanges[axisName] = {\n      min: Math.min.apply(Math, parts.concat([axisRange.min])),\n      max: Math.max.apply(Math, parts.concat([axisRange.max]))\n    };\n  };\n\n  BoxPlotChart.prototype.formatPointValue = function formatPointValue(point, format) {\n    var value = point.value;\n    return this.chartService.format.auto(format, value.lower, value.q1, value.median, value.q3, value.upper, value.mean, point.category);\n  };\n\n  BoxPlotChart.prototype.filterOutliers = function filterOutliers(items) {\n    var length = (items || []).length;\n    var result = [];\n\n    for (var i = 0; i < length; i++) {\n      var item = items[i];\n\n      if (defined(item) && item !== null) {\n        result.push(item);\n      }\n    }\n\n    return result;\n  };\n\n  return BoxPlotChart;\n}(CandlestickChart);\n\nexport default BoxPlotChart;","map":null,"metadata":{},"sourceType":"module"}