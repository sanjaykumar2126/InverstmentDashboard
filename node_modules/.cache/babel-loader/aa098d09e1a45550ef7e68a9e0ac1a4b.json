{"ast":null,"code":"import { geometry as geom } from '@progress/kendo-drawing';\nimport GridLinesMixin from './mixins/grid-lines-mixin';\nimport RadarCategoryAxis from './radar-category-axis';\nimport NumericAxis from './numeric-axis';\nimport Axis from './axis';\nimport Ring from './ring';\nimport Box from './box';\nimport { BLACK } from '../common/constants';\nimport { deepExtend, deg, getSpacing, inArray, limitValue, setDefaultOptions } from '../common';\n\nvar PolarAxis = function (Axis) {\n  function PolarAxis(options, chartService) {\n    Axis.call(this, options, chartService);\n    var instanceOptions = this.options;\n    instanceOptions.minorUnit = instanceOptions.minorUnit || instanceOptions.majorUnit / 2;\n  }\n\n  if (Axis) PolarAxis.__proto__ = Axis;\n  PolarAxis.prototype = Object.create(Axis && Axis.prototype);\n  PolarAxis.prototype.constructor = PolarAxis;\n\n  PolarAxis.prototype.getDivisions = function getDivisions(stepValue) {\n    return NumericAxis.prototype.getDivisions.call(this, stepValue) - 1;\n  };\n\n  PolarAxis.prototype.reflow = function reflow(box) {\n    this.box = box;\n    this.reflowLabels();\n  };\n\n  PolarAxis.prototype.reflowLabels = function reflowLabels() {\n    var this$1 = this;\n    var ref = this;\n    var options = ref.options;\n    var labels = ref.labels;\n    var labelOptions = ref.options.labels;\n    var skip = labelOptions.skip || 0;\n    var step = labelOptions.step || 1;\n    var measureBox = new Box();\n    var divs = this.intervals(options.majorUnit, skip, step);\n\n    for (var i = 0; i < labels.length; i++) {\n      labels[i].reflow(measureBox);\n      var labelBox = labels[i].box;\n      labels[i].reflow(this$1.getSlot(divs[i]).adjacentBox(0, labelBox.width(), labelBox.height()));\n    }\n  };\n\n  PolarAxis.prototype.lineBox = function lineBox() {\n    return this.box;\n  };\n\n  PolarAxis.prototype.intervals = function intervals(size, skipOption, stepOption, skipAngles) {\n    if (skipAngles === void 0) skipAngles = false;\n    var min = this.options.min;\n    var divisions = this.getDivisions(size);\n    var divs = [];\n    var skip = skipOption || 0;\n    var step = stepOption || 1;\n\n    for (var i = skip; i < divisions; i += step) {\n      var current = (360 + min + i * size) % 360;\n\n      if (!(skipAngles && inArray(current, skipAngles))) {\n        divs.push(current);\n      }\n    }\n\n    return divs;\n  };\n\n  PolarAxis.prototype.majorIntervals = function majorIntervals() {\n    return this.intervals(this.options.majorUnit);\n  };\n\n  PolarAxis.prototype.minorIntervals = function minorIntervals() {\n    return this.intervals(this.options.minorUnit);\n  };\n\n  PolarAxis.prototype.intervalAngle = function intervalAngle(i) {\n    return (540 - i - this.options.startAngle) % 360;\n  };\n\n  PolarAxis.prototype.createLine = function createLine() {\n    return [];\n  };\n\n  PolarAxis.prototype.majorGridLineAngles = function majorGridLineAngles(altAxis) {\n    var majorGridLines = this.options.majorGridLines;\n    return this.gridLineAngles(altAxis, this.options.majorUnit, majorGridLines.skip, majorGridLines.step);\n  };\n\n  PolarAxis.prototype.minorGridLineAngles = function minorGridLineAngles(altAxis, skipMajor) {\n    var options = this.options;\n    var minorGridLines = options.minorGridLines;\n    var majorGridLines = options.majorGridLines;\n    var majorGridLineAngles = skipMajor ? this.intervals(options.majorUnit, majorGridLines.skip, majorGridLines.step) : null;\n    return this.gridLineAngles(altAxis, options.minorUnit, minorGridLines.skip, minorGridLines.step, majorGridLineAngles);\n  };\n\n  PolarAxis.prototype.plotBandSlot = function plotBandSlot(band) {\n    return this.getSlot(band.from, band.to);\n  };\n\n  PolarAxis.prototype.getSlot = function getSlot(a, b) {\n    var ref = this;\n    var options = ref.options;\n    var box = ref.box;\n    var startAngle = options.startAngle;\n    var start = limitValue(a, options.min, options.max);\n    var end = limitValue(b || start, start, options.max);\n\n    if (options.reverse) {\n      start *= -1;\n      end *= -1;\n    }\n\n    start = (540 - start - startAngle) % 360;\n    end = (540 - end - startAngle) % 360;\n\n    if (end < start) {\n      var tmp = start;\n      start = end;\n      end = tmp;\n    }\n\n    return new Ring(box.center(), 0, box.height() / 2, start, end - start);\n  };\n\n  PolarAxis.prototype.slot = function slot(from, to) {\n    if (to === void 0) to = from;\n    var options = this.options;\n    var start = 360 - options.startAngle;\n    var slot = this.getSlot(from, to);\n    var min = Math.min(from, to);\n    var max = Math.max(from, to);\n    var startAngle, endAngle;\n\n    if (options.reverse) {\n      startAngle = min;\n      endAngle = max;\n    } else {\n      startAngle = 360 - max;\n      endAngle = 360 - min;\n    }\n\n    startAngle = (startAngle + start) % 360;\n    endAngle = (endAngle + start) % 360;\n    return new geom.Arc([slot.center.x, slot.center.y], {\n      startAngle: startAngle,\n      endAngle: endAngle,\n      radiusX: slot.radius,\n      radiusY: slot.radius\n    });\n  };\n\n  PolarAxis.prototype.getValue = function getValue(point) {\n    var options = this.options;\n    var center = this.box.center();\n    var dx = point.x - center.x;\n    var dy = point.y - center.y;\n    var theta = Math.round(deg(Math.atan2(dy, dx)));\n    var start = options.startAngle;\n\n    if (!options.reverse) {\n      theta *= -1;\n      start *= -1;\n    }\n\n    return (theta + start + 360) % 360;\n  };\n\n  PolarAxis.prototype.valueRange = function valueRange() {\n    return {\n      min: 0,\n      max: Math.PI * 2\n    };\n  };\n\n  return PolarAxis;\n}(Axis);\n\nsetDefaultOptions(PolarAxis, {\n  type: \"polar\",\n  startAngle: 0,\n  reverse: false,\n  majorUnit: 60,\n  min: 0,\n  max: 360,\n  labels: {\n    margin: getSpacing(10)\n  },\n  majorGridLines: {\n    color: BLACK,\n    visible: true,\n    width: 1\n  },\n  minorGridLines: {\n    color: \"#aaa\"\n  }\n});\ndeepExtend(PolarAxis.prototype, GridLinesMixin, {\n  createPlotBands: RadarCategoryAxis.prototype.createPlotBands,\n  majorAngles: RadarCategoryAxis.prototype.majorAngles,\n  range: NumericAxis.prototype.range,\n  labelsCount: NumericAxis.prototype.labelsCount,\n  createAxisLabel: NumericAxis.prototype.createAxisLabel\n});\nexport default PolarAxis;","map":null,"metadata":{},"sourceType":"module"}