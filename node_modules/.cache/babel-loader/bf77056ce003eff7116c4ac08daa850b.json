{"ast":null,"code":"import CategoricalChart from '../categorical-chart';\nimport BarChart from '../bar-chart/bar-chart';\nimport Bullet from './bullet';\nimport ClusterLayout from '../layout/cluster-layout';\nimport { BAR } from '../constants';\nimport { MIN_VALUE, MAX_VALUE } from '../../common/constants';\nimport { deepExtend, defined, isArray, isFunction, isObject, setDefaultOptions } from '../../common';\n\nvar BulletChart = function (CategoricalChart) {\n  function BulletChart(plotArea, options) {\n    wrapData(options);\n    CategoricalChart.call(this, plotArea, options);\n  }\n\n  if (CategoricalChart) BulletChart.__proto__ = CategoricalChart;\n  BulletChart.prototype = Object.create(CategoricalChart && CategoricalChart.prototype);\n  BulletChart.prototype.constructor = BulletChart;\n\n  BulletChart.prototype.reflowCategories = function reflowCategories(categorySlots) {\n    var children = this.children;\n    var childrenLength = children.length;\n\n    for (var i = 0; i < childrenLength; i++) {\n      children[i].reflow(categorySlots[i]);\n    }\n  };\n\n  BulletChart.prototype.plotRange = function plotRange(point) {\n    var series = point.series;\n    var valueAxis = this.seriesValueAxis(series);\n    var axisCrossingValue = this.categoryAxisCrossingValue(valueAxis);\n    return [axisCrossingValue, point.value.current || axisCrossingValue];\n  };\n\n  BulletChart.prototype.createPoint = function createPoint(data, fields) {\n    var categoryIx = fields.categoryIx;\n    var category = fields.category;\n    var series = fields.series;\n    var seriesIx = fields.seriesIx;\n    var ref = this;\n    var options = ref.options;\n    var children = ref.children;\n    var value = data.valueFields;\n    var bulletOptions = deepExtend({\n      vertical: !options.invertAxes,\n      overlay: series.overlay,\n      categoryIx: categoryIx,\n      invertAxes: options.invertAxes\n    }, series);\n    var color = data.fields.color || series.color;\n    bulletOptions = this.evalPointOptions(bulletOptions, value, category, categoryIx, series, seriesIx);\n\n    if (isFunction(series.color)) {\n      color = bulletOptions.color;\n    }\n\n    var bullet = new Bullet(value, bulletOptions);\n    bullet.color = color;\n    var cluster = children[categoryIx];\n\n    if (!cluster) {\n      cluster = new ClusterLayout({\n        vertical: options.invertAxes,\n        gap: options.gap,\n        spacing: options.spacing,\n        rtl: !options.invertAxes && (this.chartService || {}).rtl\n      });\n      this.append(cluster);\n    }\n\n    cluster.append(bullet);\n    return bullet;\n  };\n\n  BulletChart.prototype.updateRange = function updateRange(value, fields) {\n    var current = value.current;\n    var target = value.target;\n    var axisName = fields.series.axis;\n    var axisRange = this.valueAxisRanges[axisName];\n\n    if (defined(current) && !isNaN(current) && defined(target && !isNaN(target))) {\n      axisRange = this.valueAxisRanges[axisName] = axisRange || {\n        min: MAX_VALUE,\n        max: MIN_VALUE\n      };\n      axisRange.min = Math.min(axisRange.min, current, target);\n      axisRange.max = Math.max(axisRange.max, current, target);\n    }\n  };\n\n  BulletChart.prototype.formatPointValue = function formatPointValue(point, format) {\n    return this.chartService.format.auto(format, point.value.current, point.value.target);\n  };\n\n  BulletChart.prototype.pointValue = function pointValue(data) {\n    return data.valueFields.current;\n  };\n\n  BulletChart.prototype.aboveAxis = function aboveAxis(point) {\n    var value = point.value.current;\n    return value > 0;\n  };\n\n  BulletChart.prototype.createAnimation = function createAnimation() {\n    var this$1 = this;\n    var points = this.points;\n\n    this._setAnimationOptions();\n\n    for (var idx = 0; idx < points.length; idx++) {\n      var point = points[idx];\n      point.options.animation = this$1.options.animation;\n      point.createAnimation();\n    }\n  };\n\n  return BulletChart;\n}(CategoricalChart);\n\nBulletChart.prototype._setAnimationOptions = BarChart.prototype._setAnimationOptions;\nsetDefaultOptions(BulletChart, {\n  animation: {\n    type: BAR\n  }\n});\n\nfunction wrapData(options) {\n  var series = options.series;\n\n  for (var i = 0; i < series.length; i++) {\n    var seriesItem = series[i];\n    var data = seriesItem.data;\n\n    if (data && !isArray(data[0]) && !isObject(data[0])) {\n      seriesItem.data = [data];\n    }\n  }\n}\n\nexport default BulletChart;","map":null,"metadata":{},"sourceType":"module"}