{"ast":null,"code":"import { drawing as draw } from '@progress/kendo-drawing';\nimport ChartElement from './chart-element';\nimport GRADIENTS from './gradients';\nimport Box from './box';\nimport boxDiff from './utils/box-diff';\nimport { DEFAULT_WIDTH, DEFAULT_HEIGHT, WHITE, BLACK } from '../common/constants';\nimport { getSpacing, objectKey, setDefaultOptions } from '../common';\n\nvar RootElement = function (ChartElement) {\n  function RootElement(options) {\n    ChartElement.call(this, options);\n    var rootOptions = this.options;\n    rootOptions.width = parseInt(rootOptions.width, 10);\n    rootOptions.height = parseInt(rootOptions.height, 10);\n    this.gradients = {};\n  }\n\n  if (ChartElement) RootElement.__proto__ = ChartElement;\n  RootElement.prototype = Object.create(ChartElement && ChartElement.prototype);\n  RootElement.prototype.constructor = RootElement;\n\n  RootElement.prototype.reflow = function reflow() {\n    var ref = this;\n    var options = ref.options;\n    var children = ref.children;\n    var currentBox = new Box(0, 0, options.width, options.height);\n    this.box = currentBox.unpad(options.margin);\n\n    for (var i = 0; i < children.length; i++) {\n      children[i].reflow(currentBox);\n      currentBox = boxDiff(currentBox, children[i].box) || new Box();\n    }\n  };\n\n  RootElement.prototype.createVisual = function createVisual() {\n    this.visual = new draw.Group();\n    this.createBackground();\n  };\n\n  RootElement.prototype.createBackground = function createBackground() {\n    var options = this.options;\n    var border = options.border || {};\n    var box = this.box.clone().pad(options.margin).unpad(border.width);\n    var background = draw.Path.fromRect(box.toRect(), {\n      stroke: {\n        color: border.width ? border.color : \"\",\n        width: border.width,\n        dashType: border.dashType\n      },\n      fill: {\n        color: options.background,\n        opacity: options.opacity\n      },\n      zIndex: -10\n    });\n    this.visual.append(background);\n  };\n\n  RootElement.prototype.getRoot = function getRoot() {\n    return this;\n  };\n\n  RootElement.prototype.createGradient = function createGradient(options) {\n    var gradients = this.gradients;\n    var hashCode = objectKey(options);\n    var gradient = GRADIENTS[options.gradient];\n    var drawingGradient;\n\n    if (gradients[hashCode]) {\n      drawingGradient = gradients[hashCode];\n    } else {\n      var gradientOptions = Object.assign({}, gradient, options);\n\n      if (gradient.type === \"linear\") {\n        drawingGradient = new draw.LinearGradient(gradientOptions);\n      } else {\n        if (options.innerRadius) {\n          gradientOptions.stops = innerRadialStops(gradientOptions);\n        }\n\n        drawingGradient = new draw.RadialGradient(gradientOptions);\n        drawingGradient.supportVML = gradient.supportVML !== false;\n      }\n\n      gradients[hashCode] = drawingGradient;\n    }\n\n    return drawingGradient;\n  };\n\n  RootElement.prototype.cleanGradients = function cleanGradients() {\n    var gradients = this.gradients;\n\n    for (var hashCode in gradients) {\n      gradients[hashCode]._observers = []; //add clear observers method in drawing ObserversMixin\n    }\n  };\n\n  RootElement.prototype.size = function size() {\n    var options = this.options;\n    return new Box(0, 0, options.width, options.height);\n  };\n\n  return RootElement;\n}(ChartElement);\n\nsetDefaultOptions(RootElement, {\n  width: DEFAULT_WIDTH,\n  height: DEFAULT_HEIGHT,\n  background: WHITE,\n  border: {\n    color: BLACK,\n    width: 0\n  },\n  margin: getSpacing(5),\n  zIndex: -2\n});\n\nfunction innerRadialStops(options) {\n  var stops = options.stops;\n  var usedSpace = options.innerRadius / options.radius * 100;\n  var length = stops.length;\n  var currentStops = [];\n\n  for (var i = 0; i < length; i++) {\n    var currentStop = Object.assign({}, stops[i]);\n    currentStop.offset = (currentStop.offset * (100 - usedSpace) + usedSpace) / 100;\n    currentStops.push(currentStop);\n  }\n\n  return currentStops;\n}\n\nexport default RootElement;","map":null,"metadata":{},"sourceType":"module"}